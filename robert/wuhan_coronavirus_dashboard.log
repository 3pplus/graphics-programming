1                                                          The SAS System                              19:34 Saturday, March 7, 2020

NOTE: Unable to open SASUSER.REGSTRY. WORK.REGSTRY will be opened instead.
NOTE: All registry changes will be lost at the end of the session.

WARNING: Unable to copy SASUSER registry to WORK registry. Because of this, you will not see registry customizations during this 
         session.
NOTE: Unable to open SASUSER.PROFILE. WORK.PROFILE will be opened instead.
NOTE: All profile changes will be lost at the end of the session.
NOTE: Copyright (c) 2016 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M6) 
      Licensed to SAS IT, Site 70068128.
NOTE: This session is executing on the X64_10PRO  platform.



NOTE: Analytical products:
      
      SAS/STAT 15.1
      SAS/ETS 15.1
      SAS/IML 15.1
      SAS/QC 15.1

NOTE: Additional host information:

 X64_10PRO WIN 10.0.18362  Workstation

NOTE: SAS initialization used:
      real time           1.26 seconds
      cpu time            0.18 seconds
      
2                                         The SAS System             19:34 Saturday, March 7, 2020


NOTE: AUTOEXEC processing beginning; file is U:\autoexec.sas.


NOTE: AUTOEXEC processing completed.

1          %let name=wuhan_coronavirus_dashboard;
2          filename odsout '.';
3          
4          /*
5          Imitation/variation of Johns Hopkins dashboard:
6          https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd4029942346
6        ! 7b48e9ecf6
7          
8          https://github.com/CSSEGISandData/2019-nCoV/tree/master/time_series
9          https://github.com/CSSEGISandData/2019-nCoV/
10         
11         https://github.com/CSSEGISandData/COVID-19/tree/master/csse_covid_19_data/csse_covid_19
11       ! _time_series
12         https://github.com/CSSEGISandData/COVID-19/
13         */
14         
15         /*
16         Make a local copy/clone of the GitHub data.
17         gitfn_clone() needs an empty folder, therefore use a new
18         folder name each time, with the date & time in the name.
19         */
20         /*
21         %let gitfolder=./github_clone_&sysdate9._%sysfunc(tranwrd(&systime,:,_));
3                                         The SAS System             19:34 Saturday, March 7, 2020

22         %let gitfolder=./github_clone_17FEB2020;
23         */
24         
25         %let gitfolder=./github_clone_&sysdate9;
26         /*
27         */
28         data _null_;
29          rc = gitfn_clone("https://github.com/CSSEGISandData/COVID-19/",
30            "&gitfolder");
31          put rc=;
32         run;

rc=0
NOTE: DATA statement used (Total process time):
      real time           14.06 seconds
      cpu time            3.56 seconds
      

33         
34         /* ------------------ Import the confirmed cases data ---------------------- */
35         
36         /*
37         filename confdata "./&gitfolder/time_series/time_series_2019-ncov-Confirmed.csv";
38         */
39         filename confdata
39       ! "./&gitfolder/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Confirm
39       ! ed.csv";
40         proc import datafile=confdata
41          out=confirmed_data dbms=csv replace;
4                                         The SAS System             19:34 Saturday, March 7, 2020

42         getnames=yes;
43         guessingrows=all;
44         run;

45          /**********************************************************************
46          *   PRODUCT:   SAS
47          *   VERSION:   9.4
48          *   CREATOR:   External File Interface
49          *   DATE:      07MAR20
50          *   DESC:      Generated SAS Datastep Code
51          *   TEMPLATE SOURCE:  (None Specified.)
52          ***********************************************************************/
53             data WORK.CONFIRMED_DATA    ;
54             %let _EFIERR_ = 0; /* set the ERROR detection macro variable */
55             infile CONFDATA delimiter = ',' MISSOVER DSD lrecl=32767 firstobs=2 ;
56                informat Province_State $43. ;
57                informat Country_Region $22. ;
58                informat Lat best32. ;
59                informat Long best32. ;
60                informat _1_22_20 best32. ;
61                informat _1_23_20 best32. ;
62                informat _1_24_20 best32. ;
63                informat _1_25_20 best32. ;
64                informat _1_26_20 best32. ;
65                informat _1_27_20 best32. ;
66                informat _1_28_20 best32. ;
67                informat _1_29_20 best32. ;
68                informat _1_30_20 best32. ;
69                informat _1_31_20 best32. ;
5                                         The SAS System             19:34 Saturday, March 7, 2020

70                informat _2_1_20 best32. ;
71                informat _2_2_20 best32. ;
72                informat _2_3_20 best32. ;
73                informat _2_4_20 best32. ;
74                informat _2_5_20 best32. ;
75                informat _2_6_20 best32. ;
76                informat _2_7_20 best32. ;
77                informat _2_8_20 best32. ;
78                informat _2_9_20 best32. ;
79                informat _2_10_20 best32. ;
80                informat _2_11_20 best32. ;
81                informat _2_12_20 best32. ;
82                informat _2_13_20 best32. ;
83                informat _2_14_20 best32. ;
84                informat _2_15_20 best32. ;
85                informat _2_16_20 best32. ;
86                informat _2_17_20 best32. ;
87                informat _2_18_20 best32. ;
88                informat _2_19_20 best32. ;
89                informat _2_20_20 best32. ;
90                informat _2_21_20 best32. ;
91                informat _2_22_20 best32. ;
92                informat _2_23_20 best32. ;
93                informat _2_24_20 best32. ;
94                informat _2_25_20 best32. ;
95                informat _2_26_20 best32. ;
96                informat _2_27_20 best32. ;
97                informat _2_28_20 best32. ;
98                informat _2_29_20 best32. ;
6                                         The SAS System             19:34 Saturday, March 7, 2020

99                informat _3_1_20 best32. ;
100               informat _3_2_20 best32. ;
101               informat _3_3_20 best32. ;
102               informat _3_4_20 best32. ;
103               informat _3_5_20 best32. ;
104               informat _3_6_20 best32. ;
105               informat _3_7_20 best32. ;
106               format Province_State $43. ;
107               format Country_Region $22. ;
108               format Lat best12. ;
109               format Long best12. ;
110               format _1_22_20 best12. ;
111               format _1_23_20 best12. ;
112               format _1_24_20 best12. ;
113               format _1_25_20 best12. ;
114               format _1_26_20 best12. ;
115               format _1_27_20 best12. ;
116               format _1_28_20 best12. ;
117               format _1_29_20 best12. ;
118               format _1_30_20 best12. ;
119               format _1_31_20 best12. ;
120               format _2_1_20 best12. ;
121               format _2_2_20 best12. ;
122               format _2_3_20 best12. ;
123               format _2_4_20 best12. ;
124               format _2_5_20 best12. ;
125               format _2_6_20 best12. ;
126               format _2_7_20 best12. ;
127               format _2_8_20 best12. ;
7                                         The SAS System             19:34 Saturday, March 7, 2020

128               format _2_9_20 best12. ;
129               format _2_10_20 best12. ;
130               format _2_11_20 best12. ;
131               format _2_12_20 best12. ;
132               format _2_13_20 best12. ;
133               format _2_14_20 best12. ;
134               format _2_15_20 best12. ;
135               format _2_16_20 best12. ;
136               format _2_17_20 best12. ;
137               format _2_18_20 best12. ;
138               format _2_19_20 best12. ;
139               format _2_20_20 best12. ;
140               format _2_21_20 best12. ;
141               format _2_22_20 best12. ;
142               format _2_23_20 best12. ;
143               format _2_24_20 best12. ;
144               format _2_25_20 best12. ;
145               format _2_26_20 best12. ;
146               format _2_27_20 best12. ;
147               format _2_28_20 best12. ;
148               format _2_29_20 best12. ;
149               format _3_1_20 best12. ;
150               format _3_2_20 best12. ;
151               format _3_3_20 best12. ;
152               format _3_4_20 best12. ;
153               format _3_5_20 best12. ;
154               format _3_6_20 best12. ;
155               format _3_7_20 best12. ;
156            input
8                                         The SAS System             19:34 Saturday, March 7, 2020

157                        Province_State  $
158                        Country_Region  $
159                        Lat
160                        Long
161                        _1_22_20
162                        _1_23_20
163                        _1_24_20
164                        _1_25_20
165                        _1_26_20
166                        _1_27_20
167                        _1_28_20
168                        _1_29_20
169                        _1_30_20
170                        _1_31_20
171                        _2_1_20
172                        _2_2_20
173                        _2_3_20
174                        _2_4_20
175                        _2_5_20
176                        _2_6_20
177                        _2_7_20
178                        _2_8_20
179                        _2_9_20
180                        _2_10_20
181                        _2_11_20
182                        _2_12_20
183                        _2_13_20
184                        _2_14_20
185                        _2_15_20
9                                         The SAS System             19:34 Saturday, March 7, 2020

186                        _2_16_20
187                        _2_17_20
188                        _2_18_20
189                        _2_19_20
190                        _2_20_20
191                        _2_21_20
192                        _2_22_20
193                        _2_23_20
194                        _2_24_20
195                        _2_25_20
196                        _2_26_20
197                        _2_27_20
198                        _2_28_20
199                        _2_29_20
200                        _3_1_20
201                        _3_2_20
202                        _3_3_20
203                        _3_4_20
204                        _3_5_20
205                        _3_6_20
206                        _3_7_20
207            ;
208            if _ERROR_ then call symputx('_EFIERR_',1);  /* set ERROR detection macro variable
208      ! */
209            run;

NOTE: The infile CONFDATA is:
      
      Filename=U:\web\democd103\.\github_clone_07MAR2020\csse_covid_19_data\csse_covid_19_time_ser
10                                        The SAS System             19:34 Saturday, March 7, 2020

      ies\time_series_19-covid-Confirmed.csv,
      RECFM=V,LRECL=32767,File Size (bytes)=32630,
      Last Modified=07Mar2020:19:34:54,
      Create Time=07Mar2020:19:34:54

NOTE: 230 records were read from the infile CONFDATA.
      The minimum record length was 109.
      The maximum record length was 298.
NOTE: The data set WORK.CONFIRMED_DATA has 230 observations and 50 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
      

230 rows created in WORK.CONFIRMED_DATA from CONFDATA.
  
  
  
NOTE: WORK.CONFIRMED_DATA data set was successfully created.
NOTE: The data set WORK.CONFIRMED_DATA has 230 observations and 50 variables.
NOTE: PROCEDURE IMPORT used (Total process time):
      real time           1.30 seconds
      cpu time            0.17 seconds
      

210        
211        proc transpose data=confirmed_data out=confirmed_data (rename=(_name_=datestring
211      ! col1=confirmed));
212        by Province_State Country_Region Lat Long notsorted;
11                                        The SAS System             19:34 Saturday, March 7, 2020

213        run;

NOTE: There were 230 observations read from the data set WORK.CONFIRMED_DATA.
NOTE: The data set WORK.CONFIRMED_DATA has 10580 observations and 6 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.06 seconds
      cpu time            0.00 seconds
      

214        
215        /* The date/timestamp is in a string - parse it apart, and create a real date variable
215      ! */
216        data confirmed_data (drop = month day year datestring);
217         set confirmed_data;
218        if Country_Region='Others' then Country_Region='Cruise ships, etc';
219        if Country_Region='United Arab Emirates' then Country_Region='UAE';
220        month=.; month=scan(datestring,1,'_');
221        day=.; day=scan(datestring,2,'_');
222        year=.; year=2000+scan(datestring,3,'_');
223        format snapshot date9.;
224        snapshot=mdy(month,day,year);
225        run;

NOTE: Character values have been converted to numeric values at the places given by: 
      (Line):(Column).
      220:16   221:12   222:19   
NOTE: There were 10580 observations read from the data set WORK.CONFIRMED_DATA.
NOTE: The data set WORK.CONFIRMED_DATA has 10580 observations and 6 variables.
NOTE: DATA statement used (Total process time):
12                                        The SAS System             19:34 Saturday, March 7, 2020

      real time           0.00 seconds
      cpu time            0.01 seconds
      

226        /*
227        Create a table with just the latest date/timestamp.
228        You'll use this latest data in all but the timeseries plot.
229        */
230        proc sql noprint;
231        create table latest_confirmed as
232        select unique *
233        from confirmed_data
234        having snapshot=max(snapshot);
NOTE: The query requires remerging summary statistics back with the original data.
NOTE: Table WORK.LATEST_CONFIRMED created, with 230 rows and 6 columns.

235        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.13 seconds
      cpu time            0.01 seconds
      

235      !       run;
236        
237        /* Create macro variables with the data & time, to use in the title */
238        proc sql noprint;
239        select unique(snapshot) format=nldate20. into :datestr separated by ' ' from
239      ! latest_confirmed;
240        quit;
13                                        The SAS System             19:34 Saturday, March 7, 2020

NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

240      !       run;
241        
242        /* save a copy of the dataset, to use in other programs */
243        libname robsdata '.';
NOTE: Libref ROBSDATA was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: U:\web\democd103
244        data robsdata.confirmed_data; set confirmed_data;
245        run;

NOTE: There were 10580 observations read from the data set WORK.CONFIRMED_DATA.
NOTE: The data set ROBSDATA.CONFIRMED_DATA has 10580 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.10 seconds
      cpu time            0.00 seconds
      

246        
247        /* ------------------ Import the deaths data ---------------------- */
248        
249        /*
250        filename deatdata "./&gitfolder/time_series/time_series_2019-ncov-Deaths.csv";
251        */
252        filename deatdata
14                                        The SAS System             19:34 Saturday, March 7, 2020

252      ! "./&gitfolder/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Deaths.
252      ! csv";
253        proc import datafile=deatdata
254         out=death_data dbms=csv replace;
255        getnames=yes;
256        guessingrows=all;
257        run;

258         /**********************************************************************
259         *   PRODUCT:   SAS
260         *   VERSION:   9.4
261         *   CREATOR:   External File Interface
262         *   DATE:      07MAR20
263         *   DESC:      Generated SAS Datastep Code
264         *   TEMPLATE SOURCE:  (None Specified.)
265         ***********************************************************************/
266            data WORK.DEATH_DATA    ;
267            %let _EFIERR_ = 0; /* set the ERROR detection macro variable */
268            infile DEATDATA delimiter = ',' MISSOVER DSD lrecl=32767 firstobs=2 ;
269               informat Province_State $43. ;
270               informat Country_Region $22. ;
271               informat Lat best32. ;
272               informat Long best32. ;
273               informat _1_22_20 best32. ;
274               informat _1_23_20 best32. ;
275               informat _1_24_20 best32. ;
276               informat _1_25_20 best32. ;
277               informat _1_26_20 best32. ;
278               informat _1_27_20 best32. ;
15                                        The SAS System             19:34 Saturday, March 7, 2020

279               informat _1_28_20 best32. ;
280               informat _1_29_20 best32. ;
281               informat _1_30_20 best32. ;
282               informat _1_31_20 best32. ;
283               informat _2_1_20 best32. ;
284               informat _2_2_20 best32. ;
285               informat _2_3_20 best32. ;
286               informat _2_4_20 best32. ;
287               informat _2_5_20 best32. ;
288               informat _2_6_20 best32. ;
289               informat _2_7_20 best32. ;
290               informat _2_8_20 best32. ;
291               informat _2_9_20 best32. ;
292               informat _2_10_20 best32. ;
293               informat _2_11_20 best32. ;
294               informat _2_12_20 best32. ;
295               informat _2_13_20 best32. ;
296               informat _2_14_20 best32. ;
297               informat _2_15_20 best32. ;
298               informat _2_16_20 best32. ;
299               informat _2_17_20 best32. ;
300               informat _2_18_20 best32. ;
301               informat _2_19_20 best32. ;
302               informat _2_20_20 best32. ;
303               informat _2_21_20 best32. ;
304               informat _2_22_20 best32. ;
305               informat _2_23_20 best32. ;
306               informat _2_24_20 best32. ;
307               informat _2_25_20 best32. ;
16                                        The SAS System             19:34 Saturday, March 7, 2020

308               informat _2_26_20 best32. ;
309               informat _2_27_20 best32. ;
310               informat _2_28_20 best32. ;
311               informat _2_29_20 best32. ;
312               informat _3_1_20 best32. ;
313               informat _3_2_20 best32. ;
314               informat _3_3_20 best32. ;
315               informat _3_4_20 best32. ;
316               informat _3_5_20 best32. ;
317               informat _3_6_20 best32. ;
318               informat _3_7_20 best32. ;
319               format Province_State $43. ;
320               format Country_Region $22. ;
321               format Lat best12. ;
322               format Long best12. ;
323               format _1_22_20 best12. ;
324               format _1_23_20 best12. ;
325               format _1_24_20 best12. ;
326               format _1_25_20 best12. ;
327               format _1_26_20 best12. ;
328               format _1_27_20 best12. ;
329               format _1_28_20 best12. ;
330               format _1_29_20 best12. ;
331               format _1_30_20 best12. ;
332               format _1_31_20 best12. ;
333               format _2_1_20 best12. ;
334               format _2_2_20 best12. ;
335               format _2_3_20 best12. ;
336               format _2_4_20 best12. ;
17                                        The SAS System             19:34 Saturday, March 7, 2020

337               format _2_5_20 best12. ;
338               format _2_6_20 best12. ;
339               format _2_7_20 best12. ;
340               format _2_8_20 best12. ;
341               format _2_9_20 best12. ;
342               format _2_10_20 best12. ;
343               format _2_11_20 best12. ;
344               format _2_12_20 best12. ;
345               format _2_13_20 best12. ;
346               format _2_14_20 best12. ;
347               format _2_15_20 best12. ;
348               format _2_16_20 best12. ;
349               format _2_17_20 best12. ;
350               format _2_18_20 best12. ;
351               format _2_19_20 best12. ;
352               format _2_20_20 best12. ;
353               format _2_21_20 best12. ;
354               format _2_22_20 best12. ;
355               format _2_23_20 best12. ;
356               format _2_24_20 best12. ;
357               format _2_25_20 best12. ;
358               format _2_26_20 best12. ;
359               format _2_27_20 best12. ;
360               format _2_28_20 best12. ;
361               format _2_29_20 best12. ;
362               format _3_1_20 best12. ;
363               format _3_2_20 best12. ;
364               format _3_3_20 best12. ;
365               format _3_4_20 best12. ;
18                                        The SAS System             19:34 Saturday, March 7, 2020

366               format _3_5_20 best12. ;
367               format _3_6_20 best12. ;
368               format _3_7_20 best12. ;
369            input
370                        Province_State  $
371                        Country_Region  $
372                        Lat
373                        Long
374                        _1_22_20
375                        _1_23_20
376                        _1_24_20
377                        _1_25_20
378                        _1_26_20
379                        _1_27_20
380                        _1_28_20
381                        _1_29_20
382                        _1_30_20
383                        _1_31_20
384                        _2_1_20
385                        _2_2_20
386                        _2_3_20
387                        _2_4_20
388                        _2_5_20
389                        _2_6_20
390                        _2_7_20
391                        _2_8_20
392                        _2_9_20
393                        _2_10_20
394                        _2_11_20
19                                        The SAS System             19:34 Saturday, March 7, 2020

395                        _2_12_20
396                        _2_13_20
397                        _2_14_20
398                        _2_15_20
399                        _2_16_20
400                        _2_17_20
401                        _2_18_20
402                        _2_19_20
403                        _2_20_20
404                        _2_21_20
405                        _2_22_20
406                        _2_23_20
407                        _2_24_20
408                        _2_25_20
409                        _2_26_20
410                        _2_27_20
411                        _2_28_20
412                        _2_29_20
413                        _3_1_20
414                        _3_2_20
415                        _3_3_20
416                        _3_4_20
417                        _3_5_20
418                        _3_6_20
419                        _3_7_20
420            ;
421            if _ERROR_ then call symputx('_EFIERR_',1);  /* set ERROR detection macro variable
421      ! */
422            run;
20                                        The SAS System             19:34 Saturday, March 7, 2020


NOTE: The infile DEATDATA is:
      
      Filename=U:\web\democd103\.\github_clone_07MAR2020\csse_covid_19_data\csse_covid_19_time_ser
      ies\time_series_19-covid-Deaths.csv,
      RECFM=V,LRECL=32767,File Size (bytes)=29622,
      Last Modified=07Mar2020:19:34:54,
      Create Time=07Mar2020:19:34:54

NOTE: 230 records were read from the infile DEATDATA.
      The minimum record length was 105.
      The maximum record length was 241.
NOTE: The data set WORK.DEATH_DATA has 230 observations and 50 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

230 rows created in WORK.DEATH_DATA from DEATDATA.
  
  
  
NOTE: WORK.DEATH_DATA data set was successfully created.
NOTE: The data set WORK.DEATH_DATA has 230 observations and 50 variables.
NOTE: PROCEDURE IMPORT used (Total process time):
      real time           0.29 seconds
      cpu time            0.20 seconds
      

21                                        The SAS System             19:34 Saturday, March 7, 2020

423        
424        proc transpose data=death_data out=death_data (rename=(_name_=datestring col1=deaths));
425        by Province_State Country_Region Lat Long notsorted;
426        run;

NOTE: There were 230 observations read from the data set WORK.DEATH_DATA.
NOTE: The data set WORK.DEATH_DATA has 10580 observations and 6 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.03 seconds
      

427        
428        /* The date/timestamp is in a string - parse it apart, and create a real date variable
428      ! */
429        data death_data (drop = month day year datestring);
430         set death_data;
431        if Country_Region='Others' then Country_Region='Cruise ships, etc';
432        if Country_Region='United Arab Emirates' then Country_Region='UAE';
433        month=.; month=scan(datestring,1,'_');
434        day=.; day=scan(datestring,2,'_');
435        year=.; year=2000+scan(datestring,3,'_');
436        format snapshot date9.;
437        snapshot=mdy(month,day,year);
438        run;

NOTE: Character values have been converted to numeric values at the places given by: 
      (Line):(Column).
      433:16   434:12   435:19   
22                                        The SAS System             19:34 Saturday, March 7, 2020

NOTE: There were 10580 observations read from the data set WORK.DEATH_DATA.
NOTE: The data set WORK.DEATH_DATA has 10580 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

439        
440        proc sql noprint;
441        create table latest_deaths as
442        select unique *
443        from death_data
444        having snapshot=max(snapshot);
NOTE: The query requires remerging summary statistics back with the original data.
NOTE: Table WORK.LATEST_DEATHS created, with 230 rows and 6 columns.

445        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

445      !       run;
446        
447        
448        /* ------------------ Import the recovered cases data ---------------------- */
449        
450        /*
451        filename recodata "./&gitfolder/time_series/time_series_2019-ncov-Recovered.csv";
23                                        The SAS System             19:34 Saturday, March 7, 2020

452        */
453        filename recodata
453      ! "./&gitfolder/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Recover
453      ! ed.csv";
454        proc import datafile=recodata
455         out=recovered_data dbms=csv replace;
456        getnames=yes;
457        guessingrows=all;
458        run;

459         /**********************************************************************
460         *   PRODUCT:   SAS
461         *   VERSION:   9.4
462         *   CREATOR:   External File Interface
463         *   DATE:      07MAR20
464         *   DESC:      Generated SAS Datastep Code
465         *   TEMPLATE SOURCE:  (None Specified.)
466         ***********************************************************************/
467            data WORK.RECOVERED_DATA    ;
468            %let _EFIERR_ = 0; /* set the ERROR detection macro variable */
469            infile RECODATA delimiter = ',' MISSOVER DSD lrecl=32767 firstobs=2 ;
470               informat Province_State $43. ;
471               informat Country_Region $22. ;
472               informat Lat best32. ;
473               informat Long best32. ;
474               informat _1_22_20 best32. ;
475               informat _1_23_20 best32. ;
476               informat _1_24_20 best32. ;
477               informat _1_25_20 best32. ;
24                                        The SAS System             19:34 Saturday, March 7, 2020

478               informat _1_26_20 best32. ;
479               informat _1_27_20 best32. ;
480               informat _1_28_20 best32. ;
481               informat _1_29_20 best32. ;
482               informat _1_30_20 best32. ;
483               informat _1_31_20 best32. ;
484               informat _2_1_20 best32. ;
485               informat _2_2_20 best32. ;
486               informat _2_3_20 best32. ;
487               informat _2_4_20 best32. ;
488               informat _2_5_20 best32. ;
489               informat _2_6_20 best32. ;
490               informat _2_7_20 best32. ;
491               informat _2_8_20 best32. ;
492               informat _2_9_20 best32. ;
493               informat _2_10_20 best32. ;
494               informat _2_11_20 best32. ;
495               informat _2_12_20 best32. ;
496               informat _2_13_20 best32. ;
497               informat _2_14_20 best32. ;
498               informat _2_15_20 best32. ;
499               informat _2_16_20 best32. ;
500               informat _2_17_20 best32. ;
501               informat _2_18_20 best32. ;
502               informat _2_19_20 best32. ;
503               informat _2_20_20 best32. ;
504               informat _2_21_20 best32. ;
505               informat _2_22_20 best32. ;
506               informat _2_23_20 best32. ;
25                                        The SAS System             19:34 Saturday, March 7, 2020

507               informat _2_24_20 best32. ;
508               informat _2_25_20 best32. ;
509               informat _2_26_20 best32. ;
510               informat _2_27_20 best32. ;
511               informat _2_28_20 best32. ;
512               informat _2_29_20 best32. ;
513               informat _3_1_20 best32. ;
514               informat _3_2_20 best32. ;
515               informat _3_3_20 best32. ;
516               informat _3_4_20 best32. ;
517               informat _3_5_20 best32. ;
518               informat _3_6_20 best32. ;
519               informat _3_7_20 best32. ;
520               format Province_State $43. ;
521               format Country_Region $22. ;
522               format Lat best12. ;
523               format Long best12. ;
524               format _1_22_20 best12. ;
525               format _1_23_20 best12. ;
526               format _1_24_20 best12. ;
527               format _1_25_20 best12. ;
528               format _1_26_20 best12. ;
529               format _1_27_20 best12. ;
530               format _1_28_20 best12. ;
531               format _1_29_20 best12. ;
532               format _1_30_20 best12. ;
533               format _1_31_20 best12. ;
534               format _2_1_20 best12. ;
535               format _2_2_20 best12. ;
26                                        The SAS System             19:34 Saturday, March 7, 2020

536               format _2_3_20 best12. ;
537               format _2_4_20 best12. ;
538               format _2_5_20 best12. ;
539               format _2_6_20 best12. ;
540               format _2_7_20 best12. ;
541               format _2_8_20 best12. ;
542               format _2_9_20 best12. ;
543               format _2_10_20 best12. ;
544               format _2_11_20 best12. ;
545               format _2_12_20 best12. ;
546               format _2_13_20 best12. ;
547               format _2_14_20 best12. ;
548               format _2_15_20 best12. ;
549               format _2_16_20 best12. ;
550               format _2_17_20 best12. ;
551               format _2_18_20 best12. ;
552               format _2_19_20 best12. ;
553               format _2_20_20 best12. ;
554               format _2_21_20 best12. ;
555               format _2_22_20 best12. ;
556               format _2_23_20 best12. ;
557               format _2_24_20 best12. ;
558               format _2_25_20 best12. ;
559               format _2_26_20 best12. ;
560               format _2_27_20 best12. ;
561               format _2_28_20 best12. ;
562               format _2_29_20 best12. ;
563               format _3_1_20 best12. ;
564               format _3_2_20 best12. ;
27                                        The SAS System             19:34 Saturday, March 7, 2020

565               format _3_3_20 best12. ;
566               format _3_4_20 best12. ;
567               format _3_5_20 best12. ;
568               format _3_6_20 best12. ;
569               format _3_7_20 best12. ;
570            input
571                        Province_State  $
572                        Country_Region  $
573                        Lat
574                        Long
575                        _1_22_20
576                        _1_23_20
577                        _1_24_20
578                        _1_25_20
579                        _1_26_20
580                        _1_27_20
581                        _1_28_20
582                        _1_29_20
583                        _1_30_20
584                        _1_31_20
585                        _2_1_20
586                        _2_2_20
587                        _2_3_20
588                        _2_4_20
589                        _2_5_20
590                        _2_6_20
591                        _2_7_20
592                        _2_8_20
593                        _2_9_20
28                                        The SAS System             19:34 Saturday, March 7, 2020

594                        _2_10_20
595                        _2_11_20
596                        _2_12_20
597                        _2_13_20
598                        _2_14_20
599                        _2_15_20
600                        _2_16_20
601                        _2_17_20
602                        _2_18_20
603                        _2_19_20
604                        _2_20_20
605                        _2_21_20
606                        _2_22_20
607                        _2_23_20
608                        _2_24_20
609                        _2_25_20
610                        _2_26_20
611                        _2_27_20
612                        _2_28_20
613                        _2_29_20
614                        _3_1_20
615                        _3_2_20
616                        _3_3_20
617                        _3_4_20
618                        _3_5_20
619                        _3_6_20
620                        _3_7_20
621            ;
622            if _ERROR_ then call symputx('_EFIERR_',1);  /* set ERROR detection macro variable
29                                        The SAS System             19:34 Saturday, March 7, 2020

622      ! */
623            run;

NOTE: The infile RECODATA is:
      
      Filename=U:\web\democd103\.\github_clone_07MAR2020\csse_covid_19_data\csse_covid_19_time_ser
      ies\time_series_19-covid-Recovered.csv,
      RECFM=V,LRECL=32767,File Size (bytes)=31178,
      Last Modified=07Mar2020:19:34:54,
      Create Time=07Mar2020:19:34:54

NOTE: 230 records were read from the infile RECODATA.
      The minimum record length was 106.
      The maximum record length was 260.
NOTE: The data set WORK.RECOVERED_DATA has 230 observations and 50 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

230 rows created in WORK.RECOVERED_DATA from RECODATA.
  
  
  
NOTE: WORK.RECOVERED_DATA data set was successfully created.
NOTE: The data set WORK.RECOVERED_DATA has 230 observations and 50 variables.
NOTE: PROCEDURE IMPORT used (Total process time):
      real time           0.31 seconds
      cpu time            0.18 seconds
30                                        The SAS System             19:34 Saturday, March 7, 2020

      

624        
625        proc transpose data=recovered_data out=recovered_data (rename=(_name_=datestring
625      ! col1=recovered));
626        by Province_State Country_Region Lat Long notsorted;
627        run;

NOTE: There were 230 observations read from the data set WORK.RECOVERED_DATA.
NOTE: The data set WORK.RECOVERED_DATA has 10580 observations and 6 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds
      

628        
629        /* The date/timestamp is in a string - parse it apart, and create a real date variable
629      ! */
630        data recovered_data (drop = month day year datestring);
631         set recovered_data;
632        if Country_Region='Others' then Country_Region='Cruise ships, etc';
633        if Country_Region='United Arab Emirates' then Country_Region='UAE';
634        month=.; month=scan(datestring,1,'_');
635        day=.; day=scan(datestring,2,'_');
636        year=.; year=2000+scan(datestring,3,'_');
637        format snapshot dateampm.;
638        snapshot=mdy(month,day,year);
639        run;

31                                        The SAS System             19:34 Saturday, March 7, 2020

NOTE: Character values have been converted to numeric values at the places given by: 
      (Line):(Column).
      634:16   635:12   636:19   
NOTE: There were 10580 observations read from the data set WORK.RECOVERED_DATA.
NOTE: The data set WORK.RECOVERED_DATA has 10580 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds
      

640        
641        proc sql noprint;
642        create table latest_recovered as
643        select unique *
644        from recovered_data
645        having snapshot=max(snapshot);
NOTE: The query requires remerging summary statistics back with the original data.
NOTE: Table WORK.LATEST_RECOVERED created, with 230 rows and 6 columns.

646        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

646      !       run;
647        
648        
649        /* ----------------------------------------------------------------------- */
32                                        The SAS System             19:34 Saturday, March 7, 2020

650        
651        
652        goptions device=png;
653        goptions border;
654        
655        ODS LISTING CLOSE;
656        ODS html path=odsout body="&name..htm"
657         (title="COVID-19 Coronavirus Dashboard")
658         style=htmlblue;
NOTE: Writing HTML Body file: wuhan_coronavirus_dashboard.htm
659        
660        goptions gunit=pct ftitle='albany amt/bold' ftext='albany amt' htitle=28pt htext=12pt;
661        goptions cback=black ctext=graycc;
662        
663        /* Create the individual graphs, but don't display them (yet) */
664        goptions nodisplay;
665        
666        /*-------------------------------------------------------------------*/
667        
668        goptions xpixels=1400 ypixels=700;
669        data anno_black_background;
670        length function $8 color $12 style $35;
671        xsys='3'; ysys='3'; when='b';
672        function='move'; x=0; y=0; output;
673        function='bar'; x=100; y=100; style='solid'; color="black"; output;
674        run;

NOTE: The data set WORK.ANNO_BLACK_BACKGROUND has 2 observations and 8 variables.
NOTE: DATA statement used (Total process time):
33                                        The SAS System             19:34 Saturday, March 7, 2020

      real time           0.01 seconds
      cpu time            0.00 seconds
      

675        
676        /* this is the medium graph background used behind each graph */
677        data anno_gray_background; set anno_black_background;
678        color="gray22";
679        run;

NOTE: There were 2 observations read from the data set WORK.ANNO_BLACK_BACKGROUND.
NOTE: The data set WORK.ANNO_GRAY_BACKGROUND has 2 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

680        
681        /* this is the dark/black background, behind the entire dashboard */
682        proc gslide anno=anno_black_background
683         des='' name='back';
684        run;

685        
686        title;
687        
688        
689        /*-----------------------------title--------------------------------------*/
690        
34                                        The SAS System             19:34 Saturday, March 7, 2020

691        /* Use annotate & gslide to create a long/skinny title slide */
692        
693        /* xpixels=(99.5-.5)/100*1400 ypixels=(99-90)/100*700 */
694        goptions xpixels=1386 ypixels=63;

NOTE: There were 2 observations read from the data set WORK.ANNO_BLACK_BACKGROUND.
NOTE: PROCEDURE GSLIDE used (Total process time):
      real time           0.28 seconds
      cpu time            0.03 seconds
      

695        data anno_title;
696        length function $8 color $12 style $35 text $300 html $300;
697        xsys='3'; ysys='3'; when='a'; hsys='d';
698        function='label'; position='6'; color="graycc";
699        html='title='||quote("COVID-19 Coronavirus dashboard - &datestr snapshot");
700        size=20; x=2; y=60; text="COVID-19 Coronavirus Global Cases"; output;
701        size=14; x=44; y=53; text="&datestr snapshot"; output;
702        run;

NOTE: Variable style is uninitialized.
NOTE: The data set WORK.ANNO_TITLE has 2 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

703        data anno_title; set anno_gray_background anno_title;
704        run;
35                                        The SAS System             19:34 Saturday, March 7, 2020


NOTE: There were 2 observations read from the data set WORK.ANNO_GRAY_BACKGROUND.
NOTE: There were 2 observations read from the data set WORK.ANNO_TITLE.
NOTE: The data set WORK.ANNO_TITLE has 4 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

705        proc gslide anno=anno_title des='' name='title';
706        run;

707        
708        
709        /*-----------------------------info--------------------------------------*/
710        
711        /* Use annotated text in a gslide to create the info box in bottom/right corner */
712        
713        /* xpixels=(99.5-70)/100*1400 ypixels=(15-1)/100*700 */
714        goptions xpixels=413 ypixels=98;

NOTE: There were 4 observations read from the data set WORK.ANNO_TITLE.
NOTE: PROCEDURE GSLIDE used (Total process time):
      real time           0.08 seconds
      cpu time            0.03 seconds
      

715        data anno_info;
716        length function $8 color $12 style $35 text $300 html $300;
36                                        The SAS System             19:34 Saturday, March 7, 2020

717        xsys='3'; ysys='3'; when='a'; hsys='d';
718        function='label'; position='6';
719        size=11;
720        
721        y=87; html=''; function='label';
722        x=3; color="graycc"; style="albany amt"; text="Visualization by: "; output;
723        html='target="cor2"
723      ! href='||quote('https://blogs.sas.com/content/graphicallyspeaking/2020/02/03/improving-t
723      ! he-wuhan-coronavirus-dashboard/');
724        x=30; color="dodgerblue"; style="albany amt/bold"; text="Robert Allison using SAS
724      ! Software"; output;
725        
726        y=y-24; html='';
727        x=3; color="graycc"; style="albany amt"; text="Designed after: "; output;
728        html='target="cor2"
728      ! href='||quote('https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594
728      ! 740fd40299423467b48e9ecf6');
729        x=29; color="dodgerblue"; style="albany amt/bold"; text="Johns Hopkins dashboard";
729      ! output;
730        
731        y=y-24; html='';
732        x=3; color="graycc"; style="albany amt"; text="Data sources: "; output;
733        html='target="cor2"
733      ! href='||quote('https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situatio
733      ! n-reports');
734        x=28; color="dodgerblue"; style="albany amt/bold"; text="WHO,"; output;
735        html='target="cor2"
735      ! href='||quote('https://www.cdc.gov/coronavirus/2019-ncov/index.html');
736        x=x+11; color="dodgerblue"; text="CDC,"; output;
37                                        The SAS System             19:34 Saturday, March 7, 2020

737        html='target="cor2"
737      ! href='||quote('https://www.ecdc.europa.eu/en/geographical-distribution-2019-ncov-cases'
737      ! );
738        x=x+10; color="dodgerblue"; text="ECDC,"; output;
739        html='target="cor2" href='||quote('http://www.nhc.gov.cn/yjb/s3578/new_list.shtml');
740        x=x+13; color="dodgerblue"; text="NHC,"; output;
741        html='target="cor2"
741      ! href='||quote('https://3g.dxy.cn/newh5/view/pneumonia?scene=2&clicktime=1579582238&ente
741      ! rid=1579582238&from=singlemessage&isappinstalled=0');
742        x=x+10; color="dodgerblue"; text="and DXY"; output;
743        
744        y=y-24; html='';
745        x=3; color="graycc"; style="albany amt"; text="Data: "; output;
746        html='target="cor2"
746      ! href='||quote('https://github.com/CSSEGISandData/COVID-19/tree/master/csse_covid_19_dat
746      ! a/csse_covid_19_time_series');
747        x=14; color="dodgerblue"; style="albany amt/bold"; text="GitHub"; output;
748        
749        run;

NOTE: The data set WORK.ANNO_INFO has 12 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

750        data anno_info; set anno_gray_background anno_info;
751        run;

38                                        The SAS System             19:34 Saturday, March 7, 2020

NOTE: There were 2 observations read from the data set WORK.ANNO_GRAY_BACKGROUND.
NOTE: There were 12 observations read from the data set WORK.ANNO_INFO.
NOTE: The data set WORK.ANNO_INFO has 14 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

752        proc gslide anno=anno_info des='' name='info';
753        run;

754        
755        
756        /*----------------------------confsum---------------------------------------*/
757        
758        /* this is the grand sum (large number) over the confirmed table */
759        
760        /* xpixels=(15-.5)/100*1400  ypixels=(89-75)/100*700 */
761        goptions xpixels=203 ypixels=98;
762        

NOTE: There were 14 observations read from the data set WORK.ANNO_INFO.
NOTE: PROCEDURE GSLIDE used (Total process time):
      real time           0.10 seconds
      cpu time            0.09 seconds
      

763        proc sql noprint;
764        create table anno_confirmed_total as
39                                        The SAS System             19:34 Saturday, March 7, 2020

765        select sum(confirmed) as sum_confirmed from latest_confirmed;
NOTE: Table WORK.ANNO_CONFIRMED_TOTAL created, with 1 rows and 1 columns.

766        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

766      !       run;
767        data anno_confirmed_total; set anno_confirmed_total;
768        length function $8 color $12 style $35 text $300 html $300;
769        xsys='3'; ysys='3'; when='a'; hsys='d';
770        function='label'; position='5';
771        style='albany amt/bold'; color="graycc"; size=11;
772        x=50; y=84; text="Total Confirmed"; output;
773        html='title='||quote(trim(left(put(sum_confirmed,comma12.0)))||" total confirmed cases
773      ! of COVID-19 Coronavirus worldwide");
774        style='albany amt/bold'; color="red"; size=40;
775        x=50; y=50; text=trim(left(put(sum_confirmed,comma12.0))); output;
776        run;

NOTE: There were 1 observations read from the data set WORK.ANNO_CONFIRMED_TOTAL.
NOTE: The data set WORK.ANNO_CONFIRMED_TOTAL has 2 observations and 14 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

40                                        The SAS System             19:34 Saturday, March 7, 2020

777        data anno_confirmed_total; set anno_gray_background anno_confirmed_total;
778        run;

NOTE: There were 2 observations read from the data set WORK.ANNO_GRAY_BACKGROUND.
NOTE: There were 2 observations read from the data set WORK.ANNO_CONFIRMED_TOTAL.
NOTE: The data set WORK.ANNO_CONFIRMED_TOTAL has 4 observations and 14 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

779        proc gslide anno=anno_confirmed_total des='' name='confsum';
780        run;

781        
782        /*------------------------------deadsum-------------------------------------*/
783        
784        /* this is the grand sum (large number) over the deaths table */
785        
786        goptions xpixels=203 ypixels=98;

NOTE: There were 4 observations read from the data set WORK.ANNO_CONFIRMED_TOTAL.
NOTE: PROCEDURE GSLIDE used (Total process time):
      real time           0.09 seconds
      cpu time            0.06 seconds
      

787        proc sql noprint;
788        create table anno_deaths_total as
41                                        The SAS System             19:34 Saturday, March 7, 2020

789        select sum(deaths) as sum_deaths from latest_deaths;
NOTE: Table WORK.ANNO_DEATHS_TOTAL created, with 1 rows and 1 columns.

790        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

790      !       run;
791        data anno_deaths_total; set anno_deaths_total;
792        length function $8 color $12 style $35 text $300 html $300;
793        xsys='3'; ysys='3'; when='a'; hsys='d';
794        function='label'; position='5';
795        style='albany amt/bold'; color="graycc"; size=11;
796        x=50; y=84; text="Total Deaths"; output;
797        html='title='||quote(trim(left(put(sum_deaths,comma12.0)))||" deaths from COVID-19
797      ! Coronavirus worldwide");
798        style='albany amt/bold'; color="white"; size=40;
799        x=50; y=50; text=trim(left(put(sum_deaths,comma12.0))); output;
800        run;

NOTE: There were 1 observations read from the data set WORK.ANNO_DEATHS_TOTAL.
NOTE: The data set WORK.ANNO_DEATHS_TOTAL has 2 observations and 14 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

42                                        The SAS System             19:34 Saturday, March 7, 2020

801        data anno_deaths_total; set anno_gray_background anno_deaths_total;
802        run;

NOTE: There were 2 observations read from the data set WORK.ANNO_GRAY_BACKGROUND.
NOTE: There were 2 observations read from the data set WORK.ANNO_DEATHS_TOTAL.
NOTE: The data set WORK.ANNO_DEATHS_TOTAL has 4 observations and 14 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

803        proc gslide anno=anno_deaths_total des='' name='deadsum';
804        run;

805        
806        
807        /*------------------------------recosum-------------------------------------*/
808        
809        /* this is the grand sum (large number) over the recovered table */
810        
811        goptions xpixels=203 ypixels=98;

NOTE: There were 4 observations read from the data set WORK.ANNO_DEATHS_TOTAL.
NOTE: PROCEDURE GSLIDE used (Total process time):
      real time           0.09 seconds
      cpu time            0.06 seconds
      

812        proc sql noprint;
43                                        The SAS System             19:34 Saturday, March 7, 2020

813        create table anno_recovered_total as
814        select sum(recovered) as sum_recovered from latest_recovered;
NOTE: Table WORK.ANNO_RECOVERED_TOTAL created, with 1 rows and 1 columns.

815        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

815      !       run;
816        data anno_recovered_total; set anno_recovered_total;
817        length function $8 color $12 style $35 text $300 html $300;
818        xsys='3'; ysys='3'; when='a'; hsys='d';
819        function='label'; position='5';
820        style='albany amt/bold'; color="graycc"; size=11;
821        x=50; y=84; text="Total Recovered"; output;
822        html='title='||quote(trim(left(put(sum_recovered,comma12.0)))||" recovered from
822      ! COVID-19 Coronavirus worldwide");
823        style='albany amt/bold'; color="cx71a81e"; size=40;
824        x=50; y=50; text=trim(left(put(sum_recovered,comma12.0))); output;
825        run;

NOTE: There were 1 observations read from the data set WORK.ANNO_RECOVERED_TOTAL.
NOTE: The data set WORK.ANNO_RECOVERED_TOTAL has 2 observations and 14 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
44                                        The SAS System             19:34 Saturday, March 7, 2020


826        data anno_recovered_total; set anno_gray_background anno_recovered_total;
827        run;

NOTE: There were 2 observations read from the data set WORK.ANNO_GRAY_BACKGROUND.
NOTE: There were 2 observations read from the data set WORK.ANNO_RECOVERED_TOTAL.
NOTE: The data set WORK.ANNO_RECOVERED_TOTAL has 4 observations and 14 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

828        proc gslide anno=anno_recovered_total des='' name='recosum';
829        run;

830        
831        
832        /*----------------------------map---------------------------------------*/
833        
834        /* World map, with annotated red bubbles */
835        
836        /* xpixels=(69.5-15.5)/100*1400  ypixels=(89-35)/100*700 */
837        goptions xpixels=756 ypixels=378;
838        

NOTE: There were 4 observations read from the data set WORK.ANNO_RECOVERED_TOTAL.
NOTE: PROCEDURE GSLIDE used (Total process time):
      real time           0.08 seconds
      cpu time            0.06 seconds
45                                        The SAS System             19:34 Saturday, March 7, 2020

      

839        proc sql noprint;
840        create table map_data as
841        select unique country_region, avg(lat) as lat, avg(long) as long, sum(confirmed) as
841      ! confirmed
842        from latest_confirmed
843        group by country_region;
NOTE: Table WORK.MAP_DATA created, with 102 rows and 4 columns.

844        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

844      !       run;
845        
846        data map_data; set map_data;
847        /* if the average lat/long doesn't land in a good position, hard-code one */
848        if country_region='Canada' then do;
849         lat=52.7765273; long=-107.4818132;
850         end;
851        if country_region='Sweden' then do;
852         lat=63.7425748; long=16.5564647;
853         end;
854        if country_region='Russia' then do;
855         lat=55.4645521; long=37.3415677;
856         end;
46                                        The SAS System             19:34 Saturday, March 7, 2020

857        length html $300;
858        html=
859         'title='||quote(
860          trim(left(country_region))||'0d'x||
861          trim(left(put(confirmed,comma12.0)))||' confirmed cases')||
862         ' href='||quote('#'||trim(left(country_region)));
863        run;

NOTE: There were 102 observations read from the data set WORK.MAP_DATA.
NOTE: The data set WORK.MAP_DATA has 102 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

864        
865        /* The country names have to match in the data & map, for the choro map */
866        data my_map; set mapsgfk.world (where=(density<=2 and idname^='Antarctica')
866      ! drop=resolution);
NOTE: The map data sets in library MAPSGFK are based on the digital maps from GfK GeoMarketing 
      and are covered by their Copyright. For additional information, see 
      http://support.sas.com/mapsonline/gfklicense.
867        length country_region $100;
868        country_region=idname;
869        if idname='Russian Federation' then country_region='Russia';
870        if idname='China' then country_region='Mainland China';
871        if idname='United States' then country_region='US';
872        if idname='United Kingdom' then country_region='UK';
873        if idname='Viet Nam' then country_region='Vietnam';
47                                        The SAS System             19:34 Saturday, March 7, 2020

874        if idname='China/Taiwan_POC' then country_region='Taiwan';
875        if idname='United Arab Emirates' then country_region='UAE';
876        if idname='Macedonia' then country_region='North Macedonia';
877        run;

NOTE: There were 44052 observations read from the data set MAPSGFK.WORLD.
      WHERE (density<=2) and (idname not = 'Antarctica');
NOTE: The data set WORK.MY_MAP has 44052 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
      

878        proc gproject data=my_map out=my_map latlong eastlong degrees
879         project=miller2 parmout=projparm;
880        id country_region;
881        run;

NOTE: The MILLER2 projection is experimental.
NOTE: POLELAT = 12.255794.
NOTE: POLELONG = 0.000411.
NOTE: The data set WORK.PROJPARM has 1 observations and 9 variables.
NOTE: There were 44052 observations read from the data set WORK.MY_MAP.
NOTE: The data set WORK.MY_MAP has 44052 observations and 13 variables.
NOTE: PROCEDURE GPROJECT used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

48                                        The SAS System             19:34 Saturday, March 7, 2020

882        /* Project the bubble lat/longs the same way you did the map */
883        proc gproject data=map_data out=map_data latlong eastlong degrees
884         parmin=projparm parmentry=my_map;
885        id;
886        run;

NOTE: Using default parameters for entry MY_MAP from data set WORK.PROJPARM. Use NOPARMIN option 
      to disable this feature.
NOTE: POLELAT = 12.255794.
NOTE: POLELONG = 0.000411.
NOTE: There were 102 observations read from the data set WORK.MAP_DATA.
NOTE: The data set WORK.MAP_DATA has 102 observations and 7 variables.
NOTE: PROCEDURE GPROJECT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

887        
888        /* these control the size of the blue bubbles */
889        %let max_val=150000;  /* maximum number of confirmed cases (will correspond to maximum
889      ! bubble size) */
890        %let max_area=200; /* maximum bubble size (area) */
891        data anno_bubbles; set map_data;
892        length function $8 color $12 style $35 text $300 html $300;
893        xsys='2'; ysys='2'; hsys='3'; when='a';
894        function='pie'; rotate=360; style='psolid'; color="red";
895        size=.5+sqrt((confirmed/&max_val)*&max_area/3.14);
896        output;
897        run;
49                                        The SAS System             19:34 Saturday, March 7, 2020


NOTE: Variable text is uninitialized.
NOTE: There were 102 observations read from the data set WORK.MAP_DATA.
NOTE: The data set WORK.ANNO_BUBBLES has 102 observations and 17 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

898        
899        data anno_bubbles; set anno_gray_background anno_bubbles;
900        run;

NOTE: There were 2 observations read from the data set WORK.ANNO_GRAY_BACKGROUND.
NOTE: There were 102 observations read from the data set WORK.ANNO_BUBBLES.
NOTE: The data set WORK.ANNO_BUBBLES has 104 observations and 17 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

901        pattern1 v=s c=gray99;
902        proc gmap data=map_data map=my_map all anno=anno_bubbles;
903        id country_region;
904        choro confirmed / levels=1 nolegend
905         cdefault=gray55 coutline=gray77
906         html=html
907         des='' name='map';
908        run;
50                                        The SAS System             19:34 Saturday, March 7, 2020


WARNING: ID variable Country_Region is of length 22 in response data set and length 100 in map 
         data set.  This might result in ID values not matching or multiple regions to be 
         combined.

NOTE: There were 44052 observations read from the data set WORK.MY_MAP.
NOTE: There were 104 observations read from the data set WORK.ANNO_BUBBLES.
NOTE: PROCEDURE GMAP used (Total process time):
      real time           0.09 seconds
      cpu time            0.04 seconds
      

909        proc sql noprint;
910        create table not_in_map as
911        select unique country_region
912        from map_data
913        where country_region not in (select unique country_region from my_map);
NOTE: Table WORK.NOT_IN_MAP created, with 8 rows and 1 columns.

914        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.15 seconds
      cpu time            0.01 seconds
      

914      !       run;
915        
916        
917        /*--------------------------conftab-----------------------------------------*/
51                                        The SAS System             19:34 Saturday, March 7, 2020

918        
919        /* confirmed table */
920        
921        /* xpixels=(15-.5)/100*1400 ypixels=(74-1)/100*700 */
922        goptions xpixels=203 ypixels=511;
923        proc sql noprint;
924        create table anno_table_confirmed as
925        select unique country_region, sum(confirmed) as confirmed
926        from latest_confirmed
927        group by country_region;
NOTE: Table WORK.ANNO_TABLE_CONFIRMED created, with 102 rows and 2 columns.

928        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

928      !       run;
929        proc sort data=anno_table_confirmed out=anno_table_confirmed;
930        by descending confirmed country_region;
931        run;

NOTE: There were 102 observations read from the data set WORK.ANNO_TABLE_CONFIRMED.
NOTE: The data set WORK.ANNO_TABLE_CONFIRMED has 102 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
52                                        The SAS System             19:34 Saturday, March 7, 2020


932        data anno_table_confirmed; set anno_table_confirmed (obs=16);
933        if country_region='United Arab Emirates' then country_region='UAE';
934        run;

NOTE: There were 16 observations read from the data set WORK.ANNO_TABLE_CONFIRMED.
NOTE: The data set WORK.ANNO_TABLE_CONFIRMED has 16 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

935        data anno_table_confirmed; set anno_table_confirmed;
936        length function $8 color $12 style $35 text $300 html $300;
937        xsys='3'; ysys='3'; when='a'; hsys='d';
938        function='label'; style='albany amt/bold'; size=11;
939        y=99-(_n_*6);
940        text=trim(left(put(confirmed,comma12.0))); x=28; position='4'; color="red"; output;
941        text=trim(left(country_region)); x=x+5; position='6'; color="graycc"; output;
942        /* annotate an invisible box, for the html= mouse-over text */
943        html='title='||quote(trim(left(put(confirmed,comma12.0)))||" confirmed cases of
943      ! COVID-19 Coronavirus in "||trim(left(country_region)))||
944         ' href='||quote('#'||trim(left(country_region)));
945        function='move'; x=0; y=y-3; output;
946        function='bar'; x=100; y=y+5; style='empty'; line=3; size=.001; color="pink"; output;
947        run;

NOTE: There were 16 observations read from the data set WORK.ANNO_TABLE_CONFIRMED.
NOTE: The data set WORK.ANNO_TABLE_CONFIRMED has 64 observations and 16 variables.
53                                        The SAS System             19:34 Saturday, March 7, 2020

NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

948        data anno_table_confirmed; set anno_table_confirmed;
949        output;
950        if _n_=1 then do;
951         style='albany amt'; color="graycc"; text='- top 16 -'; x=50; y=y+5;  position='5';
951      ! output;
952         end;
953        run;

NOTE: There were 64 observations read from the data set WORK.ANNO_TABLE_CONFIRMED.
NOTE: The data set WORK.ANNO_TABLE_CONFIRMED has 65 observations and 16 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

954        data anno_table_confirmed; set anno_gray_background anno_table_confirmed;
955        run;

NOTE: There were 2 observations read from the data set WORK.ANNO_GRAY_BACKGROUND.
NOTE: There were 65 observations read from the data set WORK.ANNO_TABLE_CONFIRMED.
NOTE: The data set WORK.ANNO_TABLE_CONFIRMED has 67 observations and 16 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
54                                        The SAS System             19:34 Saturday, March 7, 2020

      

956        proc gslide anno=anno_table_confirmed des='' name='conftab';
957        run;

NOTE: ERROR DETECTED IN ANNOTATE= DATASET WORK.ANNO_TABLE_CONFIRMED.
NOTE: PROBLEM IN OBSERVATION     6 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    10 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    14 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    18 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    22 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    26 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    30 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    34 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    38 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    42 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    46 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    50 -
55                                        The SAS System             19:34 Saturday, March 7, 2020

      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    54 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    58 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    62 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    66 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
958        
959        
960        /*---------------------------deadtab----------------------------------------*/
961        
962        /* dead table */
963        
964        /* xpixels=(84.5-70)/100*1400 ypixels=(74-16)/100*700 */
965        goptions xpixels=203 ypixels=406;

NOTE: There were 67 observations read from the data set WORK.ANNO_TABLE_CONFIRMED.
NOTE: PROCEDURE GSLIDE used (Total process time):
      real time           0.09 seconds
      cpu time            0.07 seconds
      

966        proc sql noprint;
967        create table anno_table_deaths as
968        select unique country_region, sum(deaths) as deaths
969        from latest_deaths
970        group by country_region;
56                                        The SAS System             19:34 Saturday, March 7, 2020

NOTE: Table WORK.ANNO_TABLE_DEATHS created, with 102 rows and 2 columns.

971        quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

971      !       run;
972        proc sort data=anno_table_deaths out=anno_table_deaths;
973        by descending deaths country_region;
974        run;

NOTE: There were 102 observations read from the data set WORK.ANNO_TABLE_DEATHS.
NOTE: The data set WORK.ANNO_TABLE_DEATHS has 102 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

975        data anno_table_deaths; set anno_table_deaths (where=(deaths>0));
976        run;

NOTE: There were 19 observations read from the data set WORK.ANNO_TABLE_DEATHS.
      WHERE deaths>0;
NOTE: The data set WORK.ANNO_TABLE_DEATHS has 19 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
57                                        The SAS System             19:34 Saturday, March 7, 2020

      

977        data anno_table_deaths; set anno_table_deaths (obs=13);
978        if country_region='United Arab Emirates' then country_region='UAE';
979        run;

NOTE: There were 13 observations read from the data set WORK.ANNO_TABLE_DEATHS.
NOTE: The data set WORK.ANNO_TABLE_DEATHS has 13 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

980        data anno_table_deaths; set anno_table_deaths;
981        length function $8 color $12 style $35 text $300 html $300;
982        xsys='3'; ysys='3'; when='a'; hsys='d';
983        function='label'; style='albany amt/bold'; size=11;
984        y=98-(_n_*7);
985        text=trim(left(put(deaths,comma12.0))); x=28; position='4'; color="white"; output;
986        text=trim(left(country_region)); x=x+5; position='6'; color="graycc"; output;
987        /* annotate an invisible box, for the html= mouse-over text */
988        html='title='||quote(trim(left(put(deaths,comma12.0)))||" deaths from COVID-19
988      ! Coronavirus in "||trim(left(country_region)))||
989         ' href='||quote('#'||trim(left(country_region)));
990        function='move'; x=0; y=y-3; output;
991        function='bar'; x=100; y=y+5; style='empty'; line=3; size=.001; color="pink"; output;
992        run;

NOTE: There were 13 observations read from the data set WORK.ANNO_TABLE_DEATHS.
58                                        The SAS System             19:34 Saturday, March 7, 2020

NOTE: The data set WORK.ANNO_TABLE_DEATHS has 52 observations and 16 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

993        data anno_table_deaths; set anno_table_deaths;
994        output;
995        if _n_=1 then do;
996         style='albany amt'; color="graycc"; text='- top 13 -'; x=50; y=y+6;  position='5';
996      ! output;
997         end;
998        run;

NOTE: There were 52 observations read from the data set WORK.ANNO_TABLE_DEATHS.
NOTE: The data set WORK.ANNO_TABLE_DEATHS has 53 observations and 16 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

999        data anno_table_deaths; set anno_gray_background anno_table_deaths;
1000       run;

NOTE: There were 2 observations read from the data set WORK.ANNO_GRAY_BACKGROUND.
NOTE: There were 53 observations read from the data set WORK.ANNO_TABLE_DEATHS.
NOTE: The data set WORK.ANNO_TABLE_DEATHS has 55 observations and 16 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
59                                        The SAS System             19:34 Saturday, March 7, 2020

      cpu time            0.00 seconds
      

1001       proc gslide anno=anno_table_deaths des='' name='deadtab';
1002       run;

NOTE: ERROR DETECTED IN ANNOTATE= DATASET WORK.ANNO_TABLE_DEATHS.
NOTE: PROBLEM IN OBSERVATION     6 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    10 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    14 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    18 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    22 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    26 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    30 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    34 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    38 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    42 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    46 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
60                                        The SAS System             19:34 Saturday, March 7, 2020

NOTE: PROBLEM IN OBSERVATION    50 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    54 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
1003       
1004       
1005       /*---------------------------recotab----------------------------------------*/
1006       
1007       /* recovered table */
1008       
1009       goptions xpixels=203 ypixels=406;

NOTE: There were 55 observations read from the data set WORK.ANNO_TABLE_DEATHS.
NOTE: PROCEDURE GSLIDE used (Total process time):
      real time           0.09 seconds
      cpu time            0.07 seconds
      

1010       proc sql noprint;
1011       create table anno_table_recovered as
1012       select unique country_region, sum(recovered) as recovered
1013       from latest_recovered
1014       group by country_region;
NOTE: Table WORK.ANNO_TABLE_RECOVERED created, with 102 rows and 2 columns.

1015       quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
61                                        The SAS System             19:34 Saturday, March 7, 2020

      

1015     !       run;
1016       proc sort data=anno_table_recovered out=anno_table_recovered;
1017       by descending recovered country_region;
1018       run;

NOTE: There were 102 observations read from the data set WORK.ANNO_TABLE_RECOVERED.
NOTE: The data set WORK.ANNO_TABLE_RECOVERED has 102 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1019       data anno_table_recovered; set anno_table_recovered (where=(recovered>0));
1020       run;

NOTE: There were 38 observations read from the data set WORK.ANNO_TABLE_RECOVERED.
      WHERE recovered>0;
NOTE: The data set WORK.ANNO_TABLE_RECOVERED has 38 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1021       data anno_table_recovered; set anno_table_recovered (obs=13);
1022       if country_region='United Arab Emirates' then country_region='UAE';
1023       run;

62                                        The SAS System             19:34 Saturday, March 7, 2020

NOTE: There were 13 observations read from the data set WORK.ANNO_TABLE_RECOVERED.
NOTE: The data set WORK.ANNO_TABLE_RECOVERED has 13 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1024       data anno_table_recovered; set anno_table_recovered;
1025       length function $8 color $12 style $35 text $300 html $300;
1026       xsys='3'; ysys='3'; when='a'; hsys='d';
1027       function='label'; style='albany amt/bold'; size=11;
1028       y=98-(_n_*7);
1029       text=trim(left(put(recovered,comma12.0))); x=28; position='4'; color="cx71a81e"; output
1029     ! ;
1030       text=trim(left(country_region)); x=x+5; position='6'; color="graycc"; output;
1031       /* annotate an invisible box, for the html= mouse-over text */
1032       html='title='||quote(trim(left(put(recovered,comma12.0)))||" recovered from COVID-19
1032     ! Coronavirus in "||trim(left(country_region)))||
1033        ' href='||quote('#'||trim(left(country_region)));
1034       function='move'; x=0; y=y-3; output;
1035       function='bar'; x=100; y=y+5; style='empty'; line=3; size=.001; color="pink"; output;
1036       run;

NOTE: There were 13 observations read from the data set WORK.ANNO_TABLE_RECOVERED.
NOTE: The data set WORK.ANNO_TABLE_RECOVERED has 52 observations and 16 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
63                                        The SAS System             19:34 Saturday, March 7, 2020


1037       data anno_table_recovered; set anno_table_recovered;
1038       output;
1039       if _n_=1 then do;
1040        style='albany amt'; color="graycc"; text='- top 13 -'; x=50; y=y+6;  position='5';
1040     ! output;
1041        end;
1042       run;

NOTE: There were 52 observations read from the data set WORK.ANNO_TABLE_RECOVERED.
NOTE: The data set WORK.ANNO_TABLE_RECOVERED has 53 observations and 16 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

1043       data anno_table_recovered; set anno_gray_background anno_table_recovered;
1044       run;

NOTE: There were 2 observations read from the data set WORK.ANNO_GRAY_BACKGROUND.
NOTE: There were 53 observations read from the data set WORK.ANNO_TABLE_RECOVERED.
NOTE: The data set WORK.ANNO_TABLE_RECOVERED has 55 observations and 16 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1045       proc gslide anno=anno_table_recovered des='' name='recotab';
1046       run;
64                                        The SAS System             19:34 Saturday, March 7, 2020


NOTE: ERROR DETECTED IN ANNOTATE= DATASET WORK.ANNO_TABLE_RECOVERED.
NOTE: PROBLEM IN OBSERVATION     6 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    10 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    14 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    18 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    22 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    26 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    30 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    34 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    38 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    42 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    46 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    50 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
NOTE: PROBLEM IN OBSERVATION    54 -
      HSYS="D" is valid only for text functions. HSYS changed to '4'.
1047       
65                                        The SAS System             19:34 Saturday, March 7, 2020

1048       
1049       /*---------------------------series----------------------------------------*/
1050       
1051       /* time series graph */
1052       
1053       /* xpixels=(69.5-15.5)/100*1400 ypixels=(34-1)/100*700 */
1054       goptions xpixels=756 ypixels=231;

NOTE: There were 55 observations read from the data set WORK.ANNO_TABLE_RECOVERED.
NOTE: PROCEDURE GSLIDE used (Total process time):
      real time           0.09 seconds
      cpu time            0.04 seconds
      

1055       data summarized_series;
1056       length grouping $50;
1057       set confirmed_data;
1058       if index(country_region,'China')^=0 then grouping='Mainland China';
1059       else grouping='Other Locations';
1060       run;

NOTE: There were 10580 observations read from the data set WORK.CONFIRMED_DATA.
NOTE: The data set WORK.SUMMARIZED_SERIES has 10580 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1061       proc sql noprint;
66                                        The SAS System             19:34 Saturday, March 7, 2020

1062       create table summarized_series as
1063       select unique snapshot, grouping, sum(confirmed) as confirmed
1064       from summarized_series
1065       group by snapshot, grouping
1066       order by grouping, snapshot;
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of 
         this is a possible data integrity problem.
NOTE: Table WORK.SUMMARIZED_SERIES created, with 92 rows and 3 columns.

1067       quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

1067     !       run;
1068       data summarized_series; set summarized_series;
1069       length html $300;
1070       html='title='||quote(
1071        trim(left(grouping))||'0d'x||
1072        trim(left(put(snapshot,nldate20.)))||'0d'x||
1073        trim(left(put(confirmed,comma12.0)))||' confirmed cases'
1074        );
1075       run;

NOTE: There were 92 observations read from the data set WORK.SUMMARIZED_SERIES.
NOTE: The data set WORK.SUMMARIZED_SERIES has 92 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
67                                        The SAS System             19:34 Saturday, March 7, 2020

      cpu time            0.00 seconds
      

1076       /*
1077       There seems to be a bug in gplot mouseover text, when used in greplay in this way.
1078       Therefore I'm annotating 'invisible' circles around the gplot markers,
1079       with the html mouse-over on the annotated circles.
1080       */
1081       data anno_mouseover; set summarized_series;
1082       length function $8 color $12 style $35;
1083       xsys='2'; ysys='2'; hsys='3'; when='b';
1084       x=snapshot; y=confirmed;
1085       function='pie'; style='pempty'; size=3; rotate=360; color='gray22';
1086       html=trim(left(html))||' href='||quote('#newbar');
1087       run;

NOTE: There were 92 observations read from the data set WORK.SUMMARIZED_SERIES.
NOTE: The data set WORK.ANNO_MOUSEOVER has 92 observations and 15 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1088       proc sql noprint;
1089       select min(snapshot) format=date9. into :mindate from summarized_series;
1090       select max(snapshot) format=date9. into :maxdate from summarized_series;
1091       select max(snapshot)-min(snapshot) into :byval from summarized_series;
1092       quit;
NOTE: PROCEDURE SQL used (Total process time):
68                                        The SAS System             19:34 Saturday, March 7, 2020

      real time           0.00 seconds
      cpu time            0.01 seconds
      

1092     !       run;
1093       axis1 value=(c=graycc h=11pt) label=none minor=none offset=(0,0);
1094       axis2 label=none order=("&mindate"d to "&maxdate"d by &byval)
1095        major=(height=8pt) value=(c=graycc h=11pt font='albany amt');
1096       legend1 value=(c=graycc font="albany amt/bold" h=11pt) shape=symbol(4pct,4pct)
1097        label=(position=top font="albany amt/bold" h=11pt c=graycc "Total Confirmed Cases")
1098        position=(top left inside) mode=share across=1 repeat=2 offset=(3pct, -8pct);
1099       symbol1 interpol=sm50 height=8pt width=2 color=orange value=square;
1100       symbol2 interpol=sm50 height=8pt width=2 color=cyan value=triangle;
1101       title1 h=2pct ' ';
1102       footnote1 h=2pct ' ';
1103       data anno_mouseover; set anno_mouseover anno_gray_background;
1104       run;

NOTE: There were 92 observations read from the data set WORK.ANNO_MOUSEOVER.
NOTE: There were 2 observations read from the data set WORK.ANNO_GRAY_BACKGROUND.
NOTE: The data set WORK.ANNO_MOUSEOVER has 94 observations and 15 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1105       proc gplot data=summarized_series anno=anno_mouseover;
1106       format confirmed comma12.0;
1107       format snapshot nldate20.;
69                                        The SAS System             19:34 Saturday, March 7, 2020

1108       plot confirmed*snapshot=grouping /
1109        vaxis=axis1 haxis=axis2
1110        legend=legend1
1111        des='' name="series";
1112       run;

1113       
1114       
1115       /*-------------------------------------------------------------------*/
1116       
1117       /*
1118       turn on display again, and replay all the individual graphs
1119       into a custom greplay template layout.
1120       */
1121       
1122       goptions display;
1123       
1124       %let border=gray44;
1125       goptions xpixels=1400 ypixels=700;

NOTE: There were 92 observations read from the data set WORK.SUMMARIZED_SERIES.
NOTE: There were 94 observations read from the data set WORK.ANNO_MOUSEOVER.
NOTE: PROCEDURE GPLOT used (Total process time):
      real time           0.11 seconds
      cpu time            0.04 seconds
      

1126       proc greplay nofs igout=work.gseg tc=tempcat;
NOTE: Building list of graphs from the catalog.
70                                        The SAS System             19:34 Saturday, March 7, 2020


NOTE: Enter greplay commands or statements.
1127          tdef dash des='COVID-19 Coronavirus Dashboard'
1128          0/ llx=0       lly=0
1129             ulx=0       uly=100
1130             urx=100     ury=100
1131             lrx=100     lry=0
1132          1/ llx=.5      lly=90
1133             ulx=.5      uly=99
1134             urx=99.5    ury=99
1135             lrx=99.5    lry=90
1136             color=&border
1137          2/ llx=.5      lly=75
1138             ulx=.5      uly=89
1139             urx=15      ury=89
1140             lrx=15      lry=75
1141             color=&border
1142          3/ llx=.5      lly=1
1143             ulx=.5      uly=74
1144             urx=15      ury=74
1145             lrx=15      lry=1
1146             color=&border
1147          4/ llx=70      lly=75
1148             ulx=70      uly=89
1149             urx=84.5    ury=89
1150             lrx=84.5    lry=75
1151             color=&border
1152          5/ llx=70      lly=16
1153             ulx=70      uly=74
71                                        The SAS System             19:34 Saturday, March 7, 2020

1154             urx=84.5    ury=74
1155             lrx=84.5    lry=16
1156             color=&border
1157          6/ llx=85      lly=75
1158             ulx=85      uly=89
1159             urx=99.5    ury=89
1160             lrx=99.5    lry=75
1161             color=&border
1162          7/ llx=85      lly=16
1163             ulx=85      uly=74
1164             urx=99.5    ury=74
1165             lrx=99.5    lry=16
1166             color=&border
1167          8/ llx=15.5    lly=35
1168             ulx=15.5    uly=89
1169             urx=69.5    ury=89
1170             lrx=69.5    lry=35
1171             color=&border
1172          9/ llx=15.5    lly=1
1173             ulx=15.5    uly=34
1174             urx=69.5    ury=34
1175             lrx=69.5    lry=1
1176             color=&border
1177         10/ llx=70      lly=1
1178             ulx=70      uly=15
1179             urx=99.5    ury=15
1180             lrx=99.5    lry=1
1181             color=&border
1182          ;
72                                        The SAS System             19:34 Saturday, March 7, 2020

1183          template dash;
1184          treplay
1185           9:series
1186           0:back
1187           1:title
1188           2:confsum
1189           3:conftab
1190           4:deadsum
1191           5:deadtab
1192           6:recosum
1193           7:recotab
1194           8:map
1195          10:info
1196           des='' name="&name";
NOTE: This SAS session is using a registry in WORK.  All changes will be lost at the end of this 
      session.
NOTE: Foreground color BLACK same as background. Part of your graph might not be visible.
NOTE: 142939 bytes written to U:\web\democd103\wuhan_coronavirus_dashboard.png.
1197       run;

1198       
1199       /* -------------------------------------------------------------------- */
1200       
1201       ods graphics /
1202        noscale /* if you don't use this option, the text will be resized */
1203        imagemap tipmax=2500
1204        imagefmt=png
1205        width=800px height=600px
1206        noborder;
73                                        The SAS System             19:34 Saturday, March 7, 2020

1207       
1208       /* -------------------------------------------------------------------- */
1209       
1210       /*
1211       Create the bar chart, below the dashboard.
1212       */
1213       

NOTE: PROCEDURE GREPLAY used (Total process time):
      real time           0.68 seconds
      cpu time            0.39 seconds
      

1214       proc sql noprint;
1215       
1216       create table bar_confirmed as
1217       select unique snapshot, 'Confirmed' as type, sum(confirmed) as cumulative_cases
1218       from confirmed_data
1219       group by snapshot
1220       order by snapshot;
NOTE: Table WORK.BAR_CONFIRMED created, with 46 rows and 3 columns.

1221       
1222       create table bar_recovered as
1223       select unique snapshot, 'Recovered' as type, sum(recovered) as cumulative_cases
1224       from recovered_data
1225       group by snapshot
1226       order by snapshot;
NOTE: Table WORK.BAR_RECOVERED created, with 46 rows and 3 columns.
74                                        The SAS System             19:34 Saturday, March 7, 2020


1227       
1228       quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

1228     !       run;
1229       
1230       data bar_confirmed; set bar_confirmed;
1231       on_this_day=cumulative_cases-lag(cumulative_cases);
1232       run;

NOTE: Missing values were generated as a result of performing an operation on missing values.
      Each place is given by: (Number of times) at (Line):(Column).
      1 at 1231:29   
NOTE: There were 46 observations read from the data set WORK.BAR_CONFIRMED.
NOTE: The data set WORK.BAR_CONFIRMED has 46 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1233       
1234       data bar_recovered; set bar_recovered;
1235       on_this_day=cumulative_cases-lag(cumulative_cases);
1236       run;

75                                        The SAS System             19:34 Saturday, March 7, 2020

NOTE: Missing values were generated as a result of performing an operation on missing values.
      Each place is given by: (Number of times) at (Line):(Column).
      1 at 1235:29   
NOTE: There were 46 observations read from the data set WORK.BAR_RECOVERED.
NOTE: The data set WORK.BAR_RECOVERED has 46 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1237       
1238       data bar_data; set bar_confirmed bar_recovered;
1239       run;

NOTE: There were 46 observations read from the data set WORK.BAR_CONFIRMED.
NOTE: There were 46 observations read from the data set WORK.BAR_RECOVERED.
NOTE: The data set WORK.BAR_DATA has 92 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

1240       
1241       ods html anchor="newbar";
1242       ods graphics / imagename="wuhan_coronavirus_newbar";
1243       
1244       title1 h=18pt font='albany amt/bold' c=gray33 "COVID-19 Coronavirus - Number of new
1244     ! confirmed & recovered cases each day";
1245       title2 h=4pt ' ';
76                                        The SAS System             19:34 Saturday, March 7, 2020

1246       
1247       ods graphics / width=1400px height=600px;
1248       
1249       proc sgplot data=bar_data noborder;
1250       format snapshot nldate20.;
1251       format on_this_day comma10.0;
1252       label on_this_day='Cases on this day';
1253       styleattrs datacolors=(red cx71a81e);
1254       vbarparm category=snapshot response=on_this_day /
1255        group=type groupdisplay=cluster
1256        outlineattrs=(color=black)
1257        tip=(snapshot type on_this_day)
1258        tipformat=(nldate20. auto auto)
1259        ;
1260       keylegend / title=''
1261        location=inside position=topleft opaque border
1262        across=2 outerpad=(left=10pt top=10pt);
1263       yaxis display=(nolabel noline noticks)
1264        grid gridattrs=(pattern=dot color=gray88)
1265        valueattrs=(color=gray33 size=10pt)
1266       /* thresholdmax=1 */
1267        ;
1268       xaxis display=(nolabel)
1269        type=time values=("&mindate"d to "&maxdate"d by &byval)
1270        valueattrs=(color=gray33 size=10pt);
1271       run;

NOTE: PROCEDURE SGPLOT used (Total process time):
      real time           7.11 seconds
77                                        The SAS System             19:34 Saturday, March 7, 2020

      cpu time            0.12 seconds
      
NOTE: There were 92 observations read from the data set WORK.BAR_DATA.

1272       
1273       
1274       /* -------------------------------------------------------------------- */
1275       
1276       /*
1277       Create drilldown graphs for each country.
1278       We will jump to these graphs using html 'anchors' (by the name of the country)
1279       */
1280       
1281       proc sql noprint;
1282       
1283       create table graph_confirmed as
1284       select unique country_region, snapshot, sum(confirmed) as confirmed
1285       from confirmed_data
1286       group by country_region, snapshot
1287       order by country_region, snapshot;
NOTE: Table WORK.GRAPH_CONFIRMED created, with 4692 rows and 3 columns.

1288       
1289       create table graph_recovered as
1290       select unique country_region, snapshot, sum(recovered) as recovered
1291       from recovered_data
1292       group by country_region, snapshot
1293       order by country_region, snapshot;
NOTE: Table WORK.GRAPH_RECOVERED created, with 4692 rows and 3 columns.
78                                        The SAS System             19:34 Saturday, March 7, 2020


1294       
1295       create table graph_deaths as
1296       select unique country_region, snapshot, sum(deaths) as deaths
1297       from death_data
1298       group by country_region, snapshot
1299       order by country_region, snapshot;
NOTE: Table WORK.GRAPH_DEATHS created, with 4692 rows and 3 columns.

1300       
1301       
1302       create table graph_all as
1303       select unique graph_confirmed.*, graph_recovered.recovered
1304       from graph_confirmed left join graph_recovered
1305       on (graph_confirmed.country_region=graph_recovered.country_region) and
1305     ! (graph_confirmed.snapshot=graph_recovered.snapshot);
NOTE: Table WORK.GRAPH_ALL created, with 4692 rows and 4 columns.

1306       
1307       create table graph_all as
1308       select unique graph_all.*, graph_deaths.deaths
1309       from graph_all left join graph_deaths
1310       on (graph_all.country_region=graph_deaths.country_region) and
1310     ! (graph_all.snapshot=graph_deaths.snapshot);
WARNING: This CREATE TABLE statement recursively references the target table. A consequence of 
         this is a possible data integrity problem.
NOTE: Table WORK.GRAPH_ALL created, with 4692 rows and 5 columns.

1311       
79                                        The SAS System             19:34 Saturday, March 7, 2020

1312       quit;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.07 seconds
      cpu time            0.07 seconds
      

1312     !       run;
1313       
1314       data graph_all; set graph_all;
1315       if country_region='United Arab Emirates' then country_region='UAE';
1316       run;

NOTE: There were 4692 observations read from the data set WORK.GRAPH_ALL.
NOTE: The data set WORK.GRAPH_ALL has 4692 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

1317       
1318       proc sort data=graph_all out=graph_all;
1319       by country_region snapshot;
1320       run;

NOTE: There were 4692 observations read from the data set WORK.GRAPH_ALL.
NOTE: The data set WORK.GRAPH_ALL has 4692 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.02 seconds
      cpu time            0.01 seconds
80                                        The SAS System             19:34 Saturday, March 7, 2020

      

1321       
1322       ods html anchor="#byval(country_region)";
1323       ods graphics / imagename="wuhan_coronavirus_#byval(country_region)";
1324       
1325       options nobyline;
1326       title1 h=18pt font='albany amt/bold' c=gray33 "COVID-19 Coronavirus cases in:
1326     ! #byval(country_region)";
1327       title2 h=4pt ' ';
1328       
1329       ods graphics / width=800px height=600px;
1330       proc sgplot data=graph_all noborder;
1331       by country_region;
1332       format snapshot nldate.;
1333       format confirmed recovered deaths comma10.0;
1334       series y=confirmed x=snapshot / name='confirmed'
1335        lineattrs=(color=red thickness=2px)
1336        markers markerattrs=(color=red symbol=square);
1337       series y=recovered x=snapshot / name='recovered'
1338        lineattrs=(color=cx71a81e thickness=2px)
1339        markers markerattrs=(color=cx71a81e symbol=triangle);
1340       series y=deaths x=snapshot / name='deaths'
1341        lineattrs=(color=gray77 thickness=2px)
1342        markers markerattrs=(color=gray77 symbol=circle);
1343       keylegend 'confirmed' 'recovered' 'deaths' /
1344        location=inside position=topleft opaque border
1345        across=1 outerpad=(left=10pt top=10pt);
1346       yaxis display=(nolabel noline noticks)
81                                        The SAS System             19:34 Saturday, March 7, 2020

1347        integer thresholdmax=1 grid gridattrs=(pattern=dot color=gray88)
1348        valueattrs=(color=gray33 size=10pt);
1349       xaxis display=(nolabel)
1350        type=time values=("&mindate"d to "&maxdate"d by &byval)
1351        valueattrs=(color=gray33 size=10pt);
1352       run;

NOTE: PROCEDURE SGPLOT used (Total process time):
      real time           13.54 seconds
      cpu time            4.37 seconds
      
WARNING: The IMAGENAME option or the output name contains invalid characters. 
         wuhan_coronavirus_Cruise ships_ etc will be used as the image name prefix.
NOTE: There were 4692 observations read from the data set WORK.GRAPH_ALL.

1353       
1354       /* ------------------------------------------------------------------ */
1355       
1356       /* We don't have Hong Kong and Macau in our world map */
1357       /* That's ok - those polygons would be too small to see anyway */
1358       /* They still get a red bubble. */
1359       /*
1360       */
1361       title "country_region names not in the map";
1362       proc print data=not_in_map (where=(country_region not in (
1363        'Monaco'
1364        'Macau'
1365        'Hong Kong'
1366        'North Ireland'
82                                        The SAS System             19:34 Saturday, March 7, 2020

1367        'San Marino'
1368        'Cruise ships, etc'
1369        )));
1370       run;

NOTE: Percentage font size will not be used in titles or footnotes, use the percentage_font_size 
      option to disable this behavior.   Add options(doc='help') to the ods statement for more 
      information.
NOTE: There were 3 observations read from the data set WORK.NOT_IN_MAP.
      WHERE country_region not in ('Cruise ships, etc', 'Hong Kong', 'Macau', 'Monaco', 'North 
      Ireland', 'San Marino');
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.03 seconds
      cpu time            0.00 seconds
      

1371       
1372       quit;
1373       ODS HTML CLOSE;
1374       ODS LISTING;
NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           42.61 seconds
      cpu time            10.62 seconds
      
